<!DOCTYPE html>
<!-- saved from url=(0045)http://wiki.amperka.ru/projects:wirelessmeteo -->
<html lang="ru" dir="ltr" class="js desktop"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Беспроводная метеостанция [Амперка / Вики]</title>
    <script>(function(H){H.className=H.className.replace(/\bno-js\b/,'js')})(document.documentElement)</script>
    <meta name="generator" content="DokuWiki">
<meta name="robots" content="index,follow">
<meta name="keywords" content="projects,wirelessmeteo">
<link rel="search" type="application/opensearchdescription+xml" href="http://wiki.amperka.ru/lib/exe/opensearch.php" title="Амперка / Вики">
<link rel="start" href="http://wiki.amperka.ru/">
<link rel="contents" href="http://wiki.amperka.ru/projects:wirelessmeteo?do=index" title="Все страницы">
<link rel="alternate" type="application/rss+xml" title="Недавние изменения" href="http://wiki.amperka.ru/feed.php">
<link rel="alternate" type="application/rss+xml" title="Текущее пространство имён" href="http://wiki.amperka.ru/feed.php?mode=list&ns=projects">
<link rel="alternate" type="text/html" title="Простой HTML" href="http://wiki.amperka.ru/_export/xhtml/projects:wirelessmeteo">
<link rel="alternate" type="text/plain" title="вики-разметка" href="http://wiki.amperka.ru/_export/raw/projects:wirelessmeteo">
<link rel="canonical" href="./Беспроводная метеостанция [Амперка _ Вики]_files/Беспроводная метеостанция [Амперка _ Вики].html">
<link rel="stylesheet" type="text/css" href="./Беспроводная метеостанция [Амперка _ Вики]_files/css.php">
<script type="text/javascript">/*<![CDATA[*/var NS='projects';var JSINFO = {"id":"projects:wirelessmeteo","namespace":"projects"};
/*!]]>*/</script>
<script type="text/javascript" charset="utf-8" src="./Беспроводная метеостанция [Амперка _ Вики]_files/js.php"></script><style id="iris-css">.iris-picker{display:block;position:relative}.iris-picker,.iris-picker *{-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input+.iris-picker{margin-top:4px}.iris-error{background-color:#ffafaf}.iris-border{border-radius:3px;border:1px solid #aaa;width:200px;background-color:#fff}.iris-picker-inner{position:absolute;top:0;right:0;left:0;bottom:0}.iris-border .iris-picker-inner{top:10px;right:10px;left:10px;bottom:10px}.iris-picker .iris-square-inner{position:absolute;left:0;right:0;top:0;bottom:0}.iris-picker .iris-square,.iris-picker .iris-slider,.iris-picker .iris-square-inner,.iris-picker .iris-palette{border-radius:3px;box-shadow:inset 0 0 5px rgba(0,0,0,.4);height:100%;width:12.5%;float:left;margin-right:5%}.iris-picker .iris-square{width:76%;margin-right:10%;position:relative}.iris-picker .iris-square-inner{width:auto;margin:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-square-inner,.iris-ie-9 .iris-palette{box-shadow:none;border-radius:0}.iris-ie-9 .iris-square,.iris-ie-9 .iris-slider,.iris-ie-9 .iris-palette{outline:1px solid rgba(0,0,0,.1)}.iris-ie-lt9 .iris-square,.iris-ie-lt9 .iris-slider,.iris-ie-lt9 .iris-square-inner,.iris-ie-lt9 .iris-palette{outline:1px solid #aaa}.iris-ie-lt9 .iris-square .ui-slider-handle{outline:1px solid #aaa;background-color:#fff;-ms-filter:"alpha(Opacity=30)"}.iris-ie-lt9 .iris-square .iris-square-handle{background:0;border:3px solid #fff;-ms-filter:"alpha(Opacity=50)"}.iris-picker .iris-strip{margin-right:0;position:relative}.iris-picker .iris-strip .ui-slider-handle{position:absolute;background:0;margin:0;right:-3px;left:-3px;border:4px solid #aaa;border-width:4px 3px;width:auto;height:6px;border-radius:4px;box-shadow:0 1px 2px rgba(0,0,0,.2);opacity:.9;z-index:5;cursor:ns-resize}.iris-strip .ui-slider-handle:before{content:" ";position:absolute;left:-2px;right:-2px;top:-3px;bottom:-3px;border:2px solid #fff;border-radius:3px}.iris-picker .iris-slider-offset{position:absolute;top:11px;left:0;right:0;bottom:-3px;width:auto;height:auto;background:transparent;border:0;border-radius:0}.iris-picker .iris-square-handle{background:transparent;border:5px solid #aaa;border-radius:50%;border-color:rgba(128,128,128,.5);box-shadow:none;width:12px;height:12px;position:absolute;left:-10px;top:-10px;cursor:move;opacity:1;z-index:10}.iris-picker .ui-state-focus .iris-square-handle{opacity:.8}.iris-picker .iris-square-handle:hover{border-color:#999}.iris-picker .iris-square-value:focus .iris-square-handle{box-shadow:0 0 2px rgba(0,0,0,.75);opacity:.8}.iris-picker .iris-square-handle:hover::after{border-color:#fff}.iris-picker .iris-square-handle::after{position:absolute;bottom:-4px;right:-4px;left:-4px;top:-4px;border:3px solid #f9f9f9;border-color:rgba(255,255,255,.8);border-radius:50%;content:" "}.iris-picker .iris-square-value{width:8px;height:8px;position:absolute}.iris-ie-lt9 .iris-square-value,.iris-mozilla .iris-square-value{width:1px;height:1px}.iris-palette-container{position:absolute;bottom:0;left:0;margin:0;padding:0}.iris-border .iris-palette-container{left:10px;bottom:10px}.iris-picker .iris-palette{margin:0;cursor:pointer}.iris-square-handle,.ui-slider-handle{border:0;outline:0}</style>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="shortcut icon" href="http://wiki.amperka.ru/lib/tpl/amperka2/images/favicon.ico">
<link rel="apple-touch-icon" href="http://wiki.amperka.ru/lib/tpl/amperka2/images/apple-touch-icon.png">
    <link href="./Беспроводная метеостанция [Амперка _ Вики]_files/css" rel="stylesheet" type="text/css">
</head>

<body>
    <!--[if lte IE 8 ]><div id="IE8"><![endif]-->
    <div id="dokuwiki__site"><div id="dokuwiki__top" class="site dokuwiki mode_show tpl_amperka2     ">

        
<!-- ********** HEADER ********** -->
<div id="toolbar-wrapper">
    <div id="toolbar">
        <ul>
            <li><form action="http://wiki.amperka.ru/start" accept-charset="utf-8" class="search" id="dw__search" method="get" role="search"><div class="no"><input type="hidden" name="do" value="search"><input type="text" placeholder="Поиск" id="qsearch__in" accesskey="f" name="id" class="edit" title="[F]"><button type="submit" title="Поиск">Поиск</button><div id="qsearch__out" class="ajax_qsearch JSpopup"></div></div></form></li>
        </ul>
    </div>
</div>

<div id="dokuwiki__header"><div class="pad group">

    <ul id="scope" class="head-menu">
    <li><a href="http://wiki.amperka.ru/" class="current">Вики</a></li>
    <li><a href="http://youtube.com/AmperkaRu">Видео</a></li>
    <li><a href="http://forum.amperka.ru/">Форум</a></li>
    <li><a href="http://blog.amperka.ru/">Блог</a></li>
</ul>

    <div class="headings group">
        <!--ul class="a11y skip">
            <li><a href="#dokuwiki__content">Перейти к содержанию</a></li>
        </ul-->

        <a href="http://amperka.ru/" accesskey="h" title="[H]"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/logo.png" width="148" height="72" alt=""></a>            </div>


    <!-- BREADCRUMBS -->
    


    <hr class="a11y">
</div></div><!-- /header -->

        <div class="wrapper group">

            
            <!-- ********** CONTENT ********** -->
            <div id="dokuwiki__content"><div class="pad group">
                
                <!--div class="pageId"><span>projects:wirelessmeteo</span></div-->

                <div class="page group">
                                                            <!-- wikipage start -->
                    <!-- TOC START -->
<div id="dw__toc">
<h3 class="toggle open" style="cursor: pointer;"><strong><span>−</span></strong>Содержание</h3>
<div aria-expanded="true">

<ul class="toc" style="">
<li class="level1"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#беспроводная_метеостанция">Беспроводная метеостанция</a></div>
<ul class="toc">
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#что_это_такое">Что это такое?</a></div></li>
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#что_для_этого_необходимо">Что для этого необходимо?</a></div></li>
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#как_это_собрать">Как это собрать?</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#сборка_автономной_части">Сборка автономной части</a></div></li>
<li class="level3"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#сборка_ретранслятора">Сборка ретранслятора</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#исходный_код">Исходный код</a></div>
<ul class="toc">
<li class="level3"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#код_автономной_части">Код автономной части</a></div></li>
<li class="level3"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#код_платы_работающей_в_помещении">Код платы, работающей в помещении</a></div></li>
</ul>
</li>
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#регистрация_метеостанции_в_народном_мониторинге">Регистрация метеостанции в «Народном мониторинге»</a></div></li>
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#демонстрация_работы_устройства">Демонстрация работы устройства</a></div></li>
<li class="level2"><div class="li"><a href="http://wiki.amperka.ru/projects:wirelessmeteo#что_ещё_можно_сделать">Что ещё можно сделать?</a></div></li>
</ul></li>
</ul>
</div>
</div>
<!-- TOC END -->
                    <article class="text with-toc">
                      
<h1 class="sectionedit1" id="беспроводная_метеостанция">Беспроводная метеостанция</h1>
<div class="level1">

<p>
<a href="http://wiki.amperka.ru/_media/projects:meteo_overview.jpg" class="media" title="projects:meteo_overview.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_overview.jpg" class="mediacenter" title="meteo_overview.jpg" alt="meteo_overview.jpg" width="700"></a>
</p>
<ul>
<li class="level1"><div class="li"> Платформы: Teensy, Arduino Uno</div>
</li>
<li class="level1"><div class="li"> Языки программирования: <a href="https://en.wikipedia.org/wiki/Wiring_(development_platform)" class="interwiki iw_wp" title="https://en.wikipedia.org/wiki/Wiring_(development_platform)"> Wiring (C++)</a></div>
</li>
<li class="level1"><div class="li"> Проект на <a href="https://www.google.com/search?q=GitHub&btnI=lucky" class="interwiki iw_go" title="https://www.google.com/search?q=GitHub&amp;btnI=lucky">GitHub</a>: <a href="http://github.com/amperka-projects/wirelessmeteo" class="urlextern" title="http://github.com/amperka-projects/wirelessmeteo" rel="nofollow">http://github.com/amperka-projects/wirelessmeteo</a></div>
</li>
<li class="level1"><div class="li"> Тэги: метеостанция, погода, температура, влажность, прогноз</div>
</li>
</ul>

</div>

<h2 class="sectionedit2" id="что_это_такое">Что это такое?</h2>
<div class="level2">

<p>
В этой статье мы расскажем о том, как собрать полноценную метеостанцию,
передающую данные о погоде на широко известный сервис
«<a href="http://narodmon.ru/" class="urlextern" title="http://narodmon.ru/" rel="nofollow">народный мониторинг</a>».
</p>

<p>
Наша метеостанция будет состоять из двух устройств: компактного автономного
устройства, измеряющего погодные показатели, и устройства-ретранслятора,
получающего эти показатели и отправляющего их на «народный мониторинг».
Устройства будут связываться по беспроводному каналу связи на частоте 433&nbsp;МГц.
Автономная часть будет питаться от трёх пальчиковых батареек и сможет
просуществовать на одном комплекте батарей до года при периоде опроса датчиков
в 20&nbsp;мин.
</p>

<p>
Такая конструкция позволяет не сверлить стены для прокладки проводов с улицы, где необходимо производить измерения, в помещение, где результатами этих
измерений надо пользоваться.
</p>

</div>

<h2 class="sectionedit3" id="что_для_этого_необходимо">Что для этого необходимо?</h2>
<div class="level2">

<p>
<a href="http://wiki.amperka.ru/_media/projects:meteo_collage.jpg" class="media" title="projects:meteo_collage.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_collage.jpg" class="mediacenter" title="meteo_collage.jpg" alt="meteo_collage.jpg" width="700"></a>
</p>

<p>
Для изготовления автономного передатчика нам понадобятся:
</p>
<ol>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/teensy-31?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/teensy-31?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Teensy 3.1</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/rf-433-transmitter?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/rf-433-transmitter?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Передатчик на 433 МГц</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/temperature-humidity-sensor-sht1x?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/temperature-humidity-sensor-sht1x?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Датчик температуры и влажности</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/breadboard-mini?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/breadboard-mini?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Макетная плата Mini</a></div>
</li>
<li class="level1"><div class="li">Держатель пальчиковых батареек на x3 AA</div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/wire-mm?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/wire-mm?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Провода папа-папа ×3 шт</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/resistor?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/resistor?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Резистор на 100 кΩ</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/resistor?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/resistor?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Резистор на 10 кΩ</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/pin-headers?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/pin-headers?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Штырьковые соединители x36 контактов</a></div>
</li>
</ol>

<p>
Для изготовления ретранслятора нам понадобятся:
</p>
<ol>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/arduino-uno?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/arduino-uno?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Arduino Uno</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/arduino-ethernet?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/arduino-ethernet?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Arduino Ethernet</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/rf-433-receiver?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/rf-433-receiver?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Приёмник на 433 МГц</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/breadboard-mini?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/breadboard-mini?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Макетная плата Mini</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/wire-mm?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/wire-mm?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Провода папа-папа ×4 шт</a></div>
</li>
</ol>

<p>
Так же удобно установить два светодиода для индикации процессов:
</p>
<ol>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/wire-mm?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/wire-mm?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Провода папа-папа ×2 шт</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/led-5mm?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/led-5mm?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Светодиод красный ×1 шт</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/led-5mm?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/led-5mm?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Светодиод зелёный ×1 шт</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/resistor?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/resistor?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Резисторы на 220 Ω x2 шт</a></div>
</li>
</ol>

<p>
Для звуковой индикации разряда батареи автономной части удобно использовать
пьезо-пищалку:
</p>
<ol>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/wire-mm?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/wire-mm?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Провод папа-папа ×1 шт</a></div>
</li>
<li class="level1"><div class="li"><a href="http://amperka.ru/product/piezo-buzzer?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/piezo-buzzer?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">Пьезо-пищалка</a></div>
</li>
</ol>

</div>

<h2 class="sectionedit4" id="как_это_собрать">Как это собрать?</h2>
<div class="level2">

</div>

<h3 class="sectionedit5" id="сборка_автономной_части">Сборка автономной части</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> Припаяйте штыри к проводам батарейного отсека и воткните их в макетную плату. На этапе разработки очень удобно закрепить все элементы на какой-нибудь основе (мы использовали обычный картон). <a href="http://wiki.amperka.ru/_media/projects:meteo_build_sender_0.jpg" class="media" title="projects:meteo_build_sender_0.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_sender_0.jpg" class="mediacenter" title="meteo_build_sender_0.jpg" alt="meteo_build_sender_0.jpg" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Припаяйте штыри к отверстиям на длинных сторонах Teensy и вставьте плату в макетку. Подсоедините питание. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_sender_1.jpg" class="media" title="projects:meteo_build_sender_1.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_sender_1.jpg" class="mediacenter" title="meteo_build_sender_1.jpg" alt="meteo_build_sender_1.jpg" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Вставьте беспроводной передатчик так, чтобы его контакт <code>0</code> оказался соединённым с контактом <code>GND</code> Teensy. Контакт <code>2</code> передатчика проводом соедините с контактом <code>5</code> Teensy. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_sender_2.jpg" class="media" title="projects:meteo_build_sender_2.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_sender_2.jpg" class="mediacenter" title="meteo_build_sender_2.jpg" alt="meteo_build_sender_2.jpg" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Подсоедините резисторы так, как показано на рисунке. Это наш делитель напряжения для функции измерения напряжения питания. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_sender_3.jpg" class="media" title="projects:meteo_build_sender_3.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_sender_3.jpg" class="mediacenter" title="meteo_build_sender_3.jpg" alt="meteo_build_sender_3.jpg" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Подключите через трёхпроводные шлейфы со штырьковыми контактами датчик температуры и влажности. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_sender_4.jpg" class="media" title="projects:meteo_build_sender_4.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_sender_4.jpg" class="mediacenter" title="meteo_build_sender_4.jpg" alt="meteo_build_sender_4.jpg" width="700"></a></div>
</li>
</ol>

</div>

<h3 class="sectionedit6" id="сборка_ретранслятора">Сборка ретранслятора</h3>
<div class="level3">
<ol>
<li class="level1"><div class="li"> Вставьте Ethernet шилд в Arduino Uno, установите сверху макетку и вставьте в неё беспроводной приёмник. Подключите вывод <code>7</code> Arduino к выводу <code>2</code> приёмника. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_receiver_0.jpg" class="media" title="projects:meteo_build_receiver_0.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_receiver_0.jpg" class="mediacenter" title="meteo_build_receiver_0.jpg" alt="meteo_build_receiver_0.jpg" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Подключите питание и землю приёмника к выводам <code>GND</code> и <code>5V</code> Arduino. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_receiver_1.jpg" class="media" title="projects:meteo_build_receiver_1.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_receiver_1.jpg" class="mediacenter" title="meteo_build_receiver_1.jpg" alt="meteo_build_receiver_1.jpg" width="700"></a></div>
</li>
</ol>

<p>
На этом сборка минимально функционального ретранслятора закончена. Если вы хотите установить светодиодную индикацию и звуковую сигнализацию, то выполните пункты ниже.
</p>
<ol>
<li class="level1"><div class="li"> Установите светодиоды и резисторы, подключите красный светодиод к контакту <code>6</code>, зелёный — к контакту <code>5</code>. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_receiver_2.jpg" class="media" title="projects:meteo_build_receiver_2.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_receiver_2.jpg" class="mediacenter" title="meteo_build_receiver_2.jpg" alt="meteo_build_receiver_2.jpg" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Установите пьезопищалку, подключите её к контакту <code>4</code>. <a href="http://wiki.amperka.ru/_media/projects:meteo_build_receiver_3.jpg" class="media" title="projects:meteo_build_receiver_3.jpg"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_build_receiver_3.jpg" class="mediacenter" title="meteo_build_receiver_3.jpg" alt="meteo_build_receiver_3.jpg" width="700"></a></div>
</li>
</ol>

</div>

<h2 class="sectionedit7" id="исходный_код">Исходный код</h2>
<div class="level2">

</div>

<h3 class="sectionedit8" id="код_автономной_части">Код автономной части</h3>
<div class="level3">
<dl class="code">
<dt><a href="http://wiki.amperka.ru/_export/code/projects:wirelessmeteo?codeblock=0" title="Скачать код" class="mediafile mf_ino">meteo_sensor.ino</a></dt>
<dd><pre class="code cpp"><span class="co2">#include &lt;Arduino.h&gt;</span>
<span class="co2">#include &lt;SHT1x.h&gt;</span>
<span class="co2">#include &lt;LowPower_Teensy3.h&gt;</span>
<span class="co2">#include &lt;ampline.h&gt;</span>
&nbsp;
&nbsp;
<span class="co1">// Таймаут между посылками (не более 65535)</span>
<span class="co2">#define TIMEOUT 60000</span>
&nbsp;
<span class="co1">// Количество попыток отправки посылки</span>
<span class="co2">#define ATTEMPTS 3</span>
&nbsp;
<span class="co1">// Информационный пин передатчика</span>
<span class="co2">#define RF_PIN 5</span>
&nbsp;
<span class="co1">// Пины датчика температуры и влажности</span>
<span class="co2">#define GND1_PIN 10</span>
<span class="co2">#define VCC1_PIN 11</span>
<span class="co2">#define GND2_PIN 7</span>
<span class="co2">#define VCC2_PIN 8</span>
<span class="co2">#define DATA_PIN 12</span>
<span class="co2">#define CLK_PIN  9</span>
&nbsp;
&nbsp;
AmperkaLine rf<span class="br0">(</span>RF_PIN<span class="br0">)</span><span class="sy4">;</span>
SHT1x sht1x<span class="br0">(</span>CLK_PIN, DATA_PIN<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
&nbsp;
<span class="kw4">void</span> loop<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
&nbsp;
<span class="co1">// Функция усыпления платы. Каждые TIMEOUT секунд</span>
<span class="co1">// будет вызываться функция loop_func.</span>
TEENSY3_LP LP <span class="sy1">=</span> TEENSY3_LP<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
sleep_block_t<span class="sy2">*</span> LP_config<span class="sy4">;</span>
&nbsp;
<span class="kw4">void</span> sleep_mode<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    LP_config <span class="sy1">=</span> <span class="br0">(</span>sleep_block_t<span class="sy2">*</span><span class="br0">)</span><span class="kw3">calloc</span><span class="br0">(</span><span class="nu0">1</span>,<span class="kw3">sizeof</span><span class="br0">(</span>sleep_block_t<span class="br0">)</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Просыпаться будем по таймеру</span>
    LP_config<span class="sy2">-</span><span class="sy1">&gt;</span>modules <span class="sy1">=</span> <span class="br0">(</span>LPTMR_WAKE<span class="br0">)</span><span class="sy4">;</span>
    <span class="co1">// Задаём таймаут для таймера</span>
    LP_config<span class="sy2">-</span><span class="sy1">&gt;</span>lptmr_timeout <span class="sy1">=</span> TIMEOUT<span class="sy4">;</span>
    <span class="co1">// По истечении таймаута будет вызываться функция loop</span>
    LP_config<span class="sy2">-</span><span class="sy1">&gt;</span>callback <span class="sy1">=</span> loop<span class="sy4">;</span>
&nbsp;
    LP.<span class="me1">Hibernate</span><span class="br0">(</span>LP_config<span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
&nbsp;
<span class="co1">// Функция включения периферии</span>
<span class="kw4">void</span> periferial_start<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="co1">// Включаем линию передачи данных</span>
    pinMode<span class="br0">(</span>RF_PIN, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Включаем питания и земли датчиков температуры и влажности</span>
    pinMode<span class="br0">(</span>GND1_PIN, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span>GND2_PIN, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span>VCC1_PIN, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span>VCC2_PIN, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
    digitalWrite<span class="br0">(</span>GND1_PIN, LOW<span class="br0">)</span><span class="sy4">;</span>
    digitalWrite<span class="br0">(</span>GND2_PIN, LOW<span class="br0">)</span><span class="sy4">;</span>
    digitalWrite<span class="br0">(</span>VCC1_PIN, HIGH<span class="br0">)</span><span class="sy4">;</span>
    digitalWrite<span class="br0">(</span>VCC2_PIN, HIGH<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Включаем светодиод для индикации передачи</span>
    pinMode<span class="br0">(</span>LED_BUILTIN, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
    digitalWrite<span class="br0">(</span>LED_BUILTIN, HIGH<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Выбираем в качестве опорного напряжения внутренний</span>
    <span class="co1">// источник (=1.2 В)</span>
    analogReference<span class="br0">(</span>INTERNAL<span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
&nbsp;
<span class="co1">// Функция выключения периферии</span>
<span class="kw4">void</span> periferial_stop<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="co1">// Выключаем линию передачи данных</span>
    pinMode<span class="br0">(</span>RF_PIN, INPUT<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Выключаем датчик температуры и влажности</span>
    pinMode<span class="br0">(</span>GND1_PIN, INPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span>GND2_PIN, INPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span>VCC1_PIN, INPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span>VCC2_PIN, INPUT<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    pinMode<span class="br0">(</span><span class="nu0">18</span>, INPUT_PULLUP<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span><span class="nu0">19</span>, INPUT_PULLUP<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Выключаем светодиод</span>
    digitalWrite<span class="br0">(</span>LED_BUILTIN, LOW<span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">void</span> setup<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="co1">// Ничего не инициализируем, сразу засыпаем</span>
    sleep_mode<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="co1">// Эта функция выполняется раз в TIMEOUT секунд</span>
<span class="kw4">void</span> loop<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw4">unsigned</span> <span class="kw4">long</span> msg<span class="sy4">;</span>
    byte temp, humidity, voltage<span class="sy4">;</span>
&nbsp;
    <span class="co1">// Включаем периферию</span>
    periferial_start<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Подождём, пока включится датчик температуры и влажности</span>
    delay<span class="br0">(</span><span class="nu0">30</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Получаем входные данные с сенсоров</span>
    temp <span class="sy1">=</span> <span class="br0">(</span>byte<span class="br0">)</span><span class="br0">(</span>sht1x.<span class="me1">readTemperatureC</span><span class="br0">(</span><span class="br0">)</span> <span class="sy2">+</span> <span class="nu0">40</span>.<span class="br0">)</span><span class="sy2">*</span><span class="nu0">2</span><span class="sy4">;</span>
    humidity <span class="sy1">=</span> <span class="br0">(</span>byte<span class="br0">)</span>sht1x.<span class="me1">readHumidity</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    voltage <span class="sy1">=</span> analogRead<span class="br0">(</span>A0<span class="br0">)</span><span class="sy2">/</span><span class="nu0">4</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Составляем из данных посылку</span>
    msg <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
    msg <span class="sy3">|</span><span class="sy1">=</span> voltage<span class="sy4">;</span>
    msg <span class="sy1">&lt;&lt;=</span> <span class="nu0">8</span><span class="sy4">;</span>
    msg <span class="sy3">|</span><span class="sy1">=</span> humidity<span class="sy4">;</span>
    msg <span class="sy1">&lt;&lt;=</span> <span class="nu0">8</span><span class="sy4">;</span>
    msg <span class="sy3">|</span><span class="sy1">=</span> temp<span class="sy4">;</span>
&nbsp;
    <span class="co1">// Отправляем несколько раз посылку</span>
    <span class="kw1">for</span><span class="br0">(</span><span class="kw4">int</span> i <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span> i <span class="sy1">&lt;</span> ATTEMPTS<span class="sy4">;</span> i<span class="sy2">++</span><span class="br0">)</span> rf.<span class="me1">send</span><span class="br0">(</span>msg<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// Выключаем периферию</span>
    periferial_stop<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="co1">// После выхода из функции плата снова уснёт</span>
<span class="br0">}</span></pre>
</dd></dl>

</div>

<h3 class="sectionedit9" id="код_платы_работающей_в_помещении">Код платы, работающей в помещении</h3>
<div class="level3">
<dl class="code">
<dt><a href="http://wiki.amperka.ru/_export/code/projects:wirelessmeteo?codeblock=1" title="Скачать код" class="mediafile mf_ino">receiver.ino</a></dt>
<dd><pre class="code cpp"><span class="co2">#include &lt;Arduino.h&gt;</span>
<span class="co2">#include &lt;SPI.h&gt;</span>
<span class="co2">#include &lt;Ethernet.h&gt;</span>
<span class="co2">#include &lt;ampline.h&gt;</span>
&nbsp;
&nbsp;
byte mac<span class="br0">[</span><span class="br0">]</span> <span class="sy1">=</span> <span class="br0">{</span> <span class="nu12">0x90</span>, <span class="nu12">0xA7</span>, <span class="nu12">0xDA</span>, <span class="nu12">0x0F</span>, <span class="nu12">0xBC</span>, <span class="nu12">0x75</span> <span class="br0">}</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">char</span> server<span class="br0">[</span><span class="br0">]</span> <span class="sy1">=</span> <span class="st0">"narodmon.ru"</span><span class="sy4">;</span>
&nbsp;
EthernetClient client<span class="sy4">;</span>
&nbsp;
<span class="kw4">const</span> <span class="kw4">int</span> rfpin <span class="sy1">=</span> <span class="nu0">7</span><span class="sy4">;</span>
AmperkaLine rf<span class="br0">(</span>rfpin<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
<span class="kw4">void</span> setup<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    pinMode<span class="br0">(</span>rfpin, INPUT<span class="br0">)</span><span class="sy4">;</span>
    pinMode<span class="br0">(</span><span class="nu0">6</span>, OUTPUT<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    Serial.<span class="me1">begin</span><span class="br0">(</span><span class="nu0">9600</span><span class="br0">)</span><span class="sy4">;</span>
    Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Started."</span><span class="br0">)</span><span class="sy4">;</span>
<span class="br0">}</span>
&nbsp;
<span class="kw4">void</span> loop<span class="br0">(</span><span class="kw4">void</span><span class="br0">)</span>
<span class="br0">{</span>
    <span class="kw4">static</span> <span class="kw4">unsigned</span> <span class="kw4">long</span> pushtimeout <span class="sy1">=</span> <span class="nu0">0</span><span class="sy4">;</span>
    <span class="kw4">static</span> <span class="kw4">float</span> temp, humidity, voltage<span class="sy4">;</span>
    <span class="kw4">unsigned</span> <span class="kw4">long</span> msg<span class="sy4">;</span>
    <span class="kw4">int</span> res<span class="sy4">;</span>
&nbsp;
    <span class="kw1">if</span><span class="br0">(</span><span class="br0">(</span>res <span class="sy1">=</span> rf.<span class="me1">receive</span><span class="br0">(</span><span class="sy3">&amp;</span>msg<span class="br0">)</span><span class="br0">)</span> <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">)</span>
    <span class="br0">{</span>
        temp <span class="sy1">=</span> <span class="br0">(</span><span class="br0">(</span><span class="kw4">float</span><span class="br0">)</span><span class="br0">(</span>msg<span class="sy3">&amp;</span><span class="nu12">0xFF</span><span class="br0">)</span><span class="br0">)</span><span class="sy2">/</span><span class="nu0">2</span>. <span class="sy2">-</span> <span class="nu0">40</span>.<span class="sy4">;</span>
        msg <span class="sy1">&gt;&gt;=</span> <span class="nu0">8</span><span class="sy4">;</span>
        humidity <span class="sy1">=</span> <span class="br0">(</span><span class="kw4">float</span><span class="br0">)</span><span class="br0">(</span>msg<span class="sy3">&amp;</span><span class="nu12">0xFF</span><span class="br0">)</span><span class="sy4">;</span>
        msg <span class="sy1">&gt;&gt;=</span> <span class="nu0">8</span><span class="sy4">;</span>
        voltage <span class="sy1">=</span> <span class="br0">(</span><span class="kw4">float</span><span class="br0">)</span><span class="br0">(</span>msg<span class="sy3">&amp;</span><span class="nu12">0xFF</span><span class="br0">)</span> <span class="sy2">/</span> <span class="nu0">256</span>. <span class="sy2">*</span> <span class="nu16">1.2</span> <span class="sy2">*</span> <span class="nu0">10</span> <span class="sy2">*</span> <span class="nu16">1.1</span><span class="sy4">;</span>
&nbsp;
        digitalWrite<span class="br0">(</span><span class="nu0">6</span>, HIGH<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
        Serial.<span class="me1">print</span><span class="br0">(</span><span class="st0">"Temp: "</span><span class="br0">)</span><span class="sy4">;</span>
        Serial.<span class="me1">print</span><span class="br0">(</span>temp<span class="br0">)</span><span class="sy4">;</span>
        Serial.<span class="me1">print</span><span class="br0">(</span><span class="st0">", humidity: "</span><span class="br0">)</span><span class="sy4">;</span>
        Serial.<span class="me1">print</span><span class="br0">(</span>humidity<span class="br0">)</span><span class="sy4">;</span>
        Serial.<span class="me1">print</span><span class="br0">(</span><span class="st0">", voltage: "</span><span class="br0">)</span><span class="sy4">;</span>
        Serial.<span class="me1">println</span><span class="br0">(</span>voltage<span class="br0">)</span><span class="sy4">;</span>
&nbsp;
        digitalWrite<span class="br0">(</span><span class="nu0">6</span>, LOW<span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span>
    <span class="kw1">else</span> Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">'E'</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
    <span class="kw1">if</span><span class="br0">(</span>millis<span class="br0">(</span><span class="br0">)</span> <span class="sy2">-</span> pushtimeout <span class="sy1">&gt;</span> <span class="nu0">60000</span><span class="sy2">*</span><span class="nu0">5</span><span class="br0">)</span>
    <span class="br0">{</span>
        pushtimeout <span class="sy1">=</span> millis<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
        Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Starting Ethernet..."</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
        <span class="kw1">if</span> <span class="br0">(</span>Ethernet.<span class="me1">begin</span><span class="br0">(</span>mac<span class="br0">)</span> <span class="sy1">==</span> <span class="nu0">0</span><span class="br0">)</span>
        <span class="br0">{</span>
            Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">"Failed to configure Ethernet using DHCP"</span><span class="br0">)</span><span class="sy4">;</span>
            <span class="kw1">while</span><span class="br0">(</span><span class="nu0">1</span><span class="br0">)</span> <span class="br0">{</span> <span class="br0">}</span>
        <span class="br0">}</span>
        delay<span class="br0">(</span><span class="nu0">1000</span><span class="br0">)</span><span class="sy4">;</span>
        Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">"connecting..."</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
        <span class="kw1">if</span> <span class="br0">(</span>client.<span class="me1">connect</span><span class="br0">(</span>server, <span class="nu0">8283</span><span class="br0">)</span><span class="br0">)</span>
        <span class="br0">{</span>
            Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">"connected"</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
            client.<span class="me1">println</span><span class="br0">(</span><span class="st0">"#90-A7-DA-0F-BC-75#Sensor#55.751775#37.616856#0.0"</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
            client.<span class="me1">print</span><span class="br0">(</span><span class="st0">"#90A7DA0FBC7501#"</span><span class="br0">)</span><span class="sy4">;</span>
            client.<span class="me1">print</span><span class="br0">(</span>temp, DEC<span class="br0">)</span><span class="sy4">;</span>
            client.<span class="me1">println</span><span class="br0">(</span><span class="st0">"#In"</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
            client.<span class="me1">print</span><span class="br0">(</span><span class="st0">"#90A7DA0FBC7502#"</span><span class="br0">)</span><span class="sy4">;</span>
            client.<span class="me1">print</span><span class="br0">(</span>humidity, DEC<span class="br0">)</span><span class="sy4">;</span>
            client.<span class="me1">println</span><span class="br0">(</span><span class="st0">"#Humidity"</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
            client.<span class="me1">print</span><span class="br0">(</span><span class="st0">"#90A7DA0FBC7503#"</span><span class="br0">)</span><span class="sy4">;</span>
            client.<span class="me1">print</span><span class="br0">(</span>voltage, DEC<span class="br0">)</span><span class="sy4">;</span>
            client.<span class="me1">println</span><span class="br0">(</span><span class="st0">"#Voltage"</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
            client.<span class="me1">println</span><span class="br0">(</span><span class="st0">"##"</span><span class="br0">)</span><span class="sy4">;</span>
        <span class="br0">}</span> 
        <span class="kw1">else</span> Serial.<span class="me1">println</span><span class="br0">(</span><span class="st0">"connection failed"</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
        <span class="br0">{</span>
            <span class="kw4">unsigned</span> <span class="kw4">long</span> <span class="kw4">tm</span> <span class="sy1">=</span> millis<span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
&nbsp;
            <span class="kw1">while</span><span class="br0">(</span>millis<span class="br0">(</span><span class="br0">)</span> <span class="sy2">-</span> <span class="kw4">tm</span> <span class="sy1">&lt;</span> <span class="nu0">5000</span><span class="br0">)</span> <span class="br0">{</span>
                <span class="kw1">if</span> <span class="br0">(</span>client.<span class="me1">available</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span> <span class="br0">{</span>
                    <span class="kw4">char</span> c <span class="sy1">=</span> client.<span class="me1">read</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
                    Serial.<span class="me1">print</span><span class="br0">(</span>c<span class="br0">)</span><span class="sy4">;</span>
                <span class="br0">}</span>
            <span class="br0">}</span>
        <span class="br0">}</span>
&nbsp;
        client.<span class="me1">stop</span><span class="br0">(</span><span class="br0">)</span><span class="sy4">;</span>
    <span class="br0">}</span>
<span class="br0">}</span></pre>
</dd></dl>

</div>

<h2 class="sectionedit10" id="регистрация_метеостанции_в_народном_мониторинге">Регистрация метеостанции в «Народном мониторинге»</h2>
<div class="level2">

<p>
Чтобы данные, передаваемые нашим устройством, корректно отображались на народном
мониторинге, необходимо выполнить следующее:
</p>
<ol>
<li class="level1"><div class="li"> Установить уникальный MAC-адрес устройства.</div>
</li>
<li class="level1"><div class="li"> Зарегистрироваться на сайте «Народного мониторинга».<a href="http://wiki.amperka.ru/_media/projects:meteo_register.png" class="media" title="projects:meteo_register.png"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_register.png" class="mediacenter" alt="" width="700"></a></div>
</li>
<li class="level1"><div class="li"> Авторизоваться.</div>
</li>
<li class="level1"><div class="li"> Открыть список датчиков и установить номиналы передаваемых данных.<a href="http://wiki.amperka.ru/_media/projects:meteo_sensorsfix.png" class="media" title="projects:meteo_sensorsfix.png"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/projects-meteo_sensorsfix.png" class="mediacenter" alt="" width="700"></a></div>
</li>
</ol>

</div>

<h2 class="sectionedit11" id="демонстрация_работы_устройства">Демонстрация работы устройства</h2>
<div class="level2">
<iframe src="./Беспроводная метеостанция [Амперка _ Вики]_files/1Iv1meDU588.html" height="406" width="520" class="vshare__none" allowfullscreen="" frameborder="0" scrolling="no"></iframe>
</div>

<h2 class="sectionedit12" id="что_ещё_можно_сделать">Что ещё можно сделать?</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Мы установили только сенсор температуры и влажности. Но у Teensy остаётся ещё много свободных ножек, т.ч. можно добавить разных датчиков: <a href="http://amperka.ru/product/ldr?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/ldr?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">освещённости</a>, <a href="http://amperka.ru/product/barometer?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/barometer?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">атмосферного давления</a>, <a href="http://amperka.ru/product/anemometer-kit?utm_source=proj&utm_campaign=wirelessmeteo&utm_medium=wiki" class="interwiki iw_amp" title="http://amperka.ru/product/anemometer-kit?utm_source=proj&amp;utm_campaign=wirelessmeteo&amp;utm_medium=wiki">скорости&nbsp;ветра</a> и т.д.</div>
</li>
<li class="level1"><div class="li"> Teensy прямо на борту имеет часы реального времени (RTC). Для их работоспособности не хватает только кварца. Можно купить кварц на 32,768 КГц в любом магазине радиоэлементов и припаять его. Тогда можно пробуждать Teensy по будильнику RTC. Достоинство в том, что можно будить устройство чаще в те часы, когда нужны более точные показания. Например, в рабочее время будить устройство каждые 5 минут, а в остальное — каждые полчаса.</div>
</li>
</ol>

</div>

                    </article>
                    <!-- wikipage stop -->
                                    </div>

                            </div></div><!-- /content -->

            <hr class="a11y">

        </div><!-- /wrapper -->

        
<!-- ********** FOOTER ********** -->
<div id="dokuwiki__footer"><div class="pad">
    <div id="license">
      <div class="license">За исключением случаев, когда указано иное, содержимое этой вики предоставляется на условиях следующей лицензии: <bdi><a href="http://creativecommons.org/licenses/by-nc-sa/3.0/" rel="license" class="urlextern">CC Attribution-Noncommercial-Share Alike 3.0 Unported</a></bdi></div>      Производные работы должны содержать
      ссылку на http://wiki.amperka.ru, как на первоисточник, <i>непосредственно перед</i>
      содержимым работы.<br>
      Вики работает на суперском движке <a href="http://www.dokuwiki.org/">DokuWiki</a>.
    </div>

    <div class="docInfo">
      <bdi>projects/wirelessmeteo.txt</bdi> · Последние изменения: 2014/12/04 16:20  — <bdi>alev</bdi>
      <!-- PAGE ACTIONS -->
      <div id="pagetools">
          <h3 class="a11y">Инструменты страницы</h3>
          <div class="tools">
              <ul>
                  <li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=edit" class="action source" accesskey="v" rel="nofollow" title="Показать исходный текст [V]"><span>Показать исходный текст</span></a></li><li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=revisions" class="action revs" accesskey="o" rel="nofollow" title="История страницы [O]"><span>История страницы</span></a></li><li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=backlink" class="action backlink" rel="nofollow" title="Ссылки сюда"><span>Ссылки сюда</span></a></li><li><a href="http://wiki.amperka.ru/projects:wirelessmeteo#dokuwiki__top" class="action top" accesskey="t" rel="nofollow" title="Наверх [T]"><span>Наверх</span></a></li>              </ul>
          </div>
      </div>
    </div>

    <div id="wiki-toolset" class="tools group">
        <!-- USER TOOLS -->
                    <div id="usertools">
                <h3 class="a11y">Инструменты пользователя</h3>
                <ul>
                    <li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=register" class="action register" rel="nofollow" title="Зарегистрироваться">Зарегистрироваться</a></li><li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=login&sectok=3da475ff3e7c10b45643afab3e9bab78" class="action login" rel="nofollow" title="Войти">Войти</a></li>                </ul>
            </div>
        
        <!-- SITE TOOLS -->
        <div id="sitetools">
            <!--h3 class="a11y">Инструменты сайта</h3>
            <div class="mobileTools">
                <form action="/doku.php" method="get" accept-charset="utf-8"><div class="no"><input type="hidden" name="id" value="projects:wirelessmeteo" /><select name="do" class="edit quickselect" title="Инструменты"><option value="">Инструменты</option><optgroup label="Инструменты страницы"><option value="edit">Показать исходный текст</option><option value="revisions">История страницы</option><option value="backlink">Ссылки сюда</option></optgroup><optgroup label="Инструменты сайта"><option value="recent">Недавние изменения</option><option value="media">Управление медиафайлами</option><option value="index">Все страницы</option></optgroup><optgroup label="Инструменты пользователя"><option value="login">Войти</option><option value="register">Зарегистрироваться</option></optgroup></select><button type="submit">&gt;</button></div></form>            </div-->
            <ul>
                <li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=recent" class="action recent" accesskey="r" rel="nofollow" title="Недавние изменения [R]">Недавние изменения</a></li><li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=media&ns=projects" class="action media" rel="nofollow" title="Управление медиафайлами">Управление медиафайлами</a></li><li><a href="http://wiki.amperka.ru/projects:wirelessmeteo?do=index" class="action index" accesskey="x" rel="nofollow" title="Все страницы [X]">Все страницы</a></li>            </ul>
        </div>

    </div>
</div></div><!-- /footer -->

<!-- Yandex.Metrika -->
<script src="http://mc.yandex.ru/metrika/watch.js" type="text/javascript"></script>
<div style="display:none;"><script type="text/javascript">
try { var yaCounter1777561 = new Ya.Metrika(1777561);
yaCounter1777561.clickmap(true);
yaCounter1777561.trackLinks(true);
} catch(e){}
</script></div>
<noscript>&lt;div style="position:absolute"&gt;&lt;img src="//mc.yandex.ru/watch/1777561" alt="" /&gt;&lt;/div&gt;</noscript>
<!-- /Yandex.Metrika -->
    </div></div><!-- /site -->

    <div class="no"><img src="./Беспроводная метеостанция [Амперка _ Вики]_files/indexer.php" width="2" height="1" alt=""></div>
    <div id="screen__mode" class="no"></div>    <!--[if lte IE 8 ]></div><![endif]-->


</body></html>